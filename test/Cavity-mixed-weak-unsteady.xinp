<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<simulation>

  <geometry>
    <raiseorder patch="1" u="2" v="2"/>
    <refine patch="1" u="0" v="0"/>
    <topologysets>
      <set name="vertical" type="edge">
        <item patch="1">1 2</item>
      </set>
      <set name="horizontal" type="edge">
        <item patch="1">3 4</item>
      </set>
      <set name="faces" type="edge">
        <item patch="1">1 2 3 4</item>
      </set>
    </topologysets>
  </geometry>

  <stokes>
    <!-- Time-dependent dirichlet conditions with constrain_integrated_pressure is borked -->
    <boundaryconditions>
      <dirichlet set="vertical" basis="1" comp="1"/>
      <dirichlet set="horizontal" basis="1" comp="2"/>
      <neumann set="faces" direction="-1" type="generic">0|0</neumann>
    </boundaryconditions>
    <source type="expression">
      (pow(x,2)-2*pow(x,3)+pow(x,4))*(2*y-6*pow(y,2)+4*pow(y,3))*cos(t) + (-(2-12*x+12*pow(x,2))*(2*y-6*pow(y,2)+4*pow(y,3))-(pow(x,2)-2*pow(x,3)+pow(x,4))*(-12+24*y))*sin(t) |
		  -(2*x-6*pow(x,2)+4*pow(x,3))*(pow(y,2)-2*pow(y,3)+pow(y,4))*cos(t) + ((-12+24*x)*(pow(y,2)-2*pow(y,3)+pow(y,4))+(2*x-6*pow(x,2)+4*pow(x,3))*(2-12*y+12*pow(y,2)))*sin(t)
    </source>
    <constrain_integrated_pressure/>
    <fluidproperties mu="1.0" rho="1.0"/>
    <gravity x="0" y="0" z="0"/>
    <anasol type="expression">
      <primary>
        (pow(x,2)-2*pow(x,3)+pow(x,4))*(2*y-6*pow(y,2)+4*pow(y,3))*sin(t) |
		    -(2*x-6*pow(x,2)+4*pow(x,3))*(pow(y,2)-2*pow(y,3)+pow(y,4))*sin(t) |
		    0
      </primary>
      <scalarprimary>0</scalarprimary>
      <secondary>
        (2*x-6*pow(x,2)+4*pow(x,3))*(2*y-6*pow(y,2)+4*pow(y,3))*sin(t) |
		    (pow(x,2)-2*pow(x,3)+pow(x,4))*(2-12*y+12*pow(y,2))*sin(t) |
		    -(2-12*x+12*pow(x,2))*(pow(y,2)-2*pow(y,3)+pow(y,4))*sin(t) |
		    -(2*x-6*pow(x,2)+4*pow(x,3))*(2*y-6*pow(y,2)+4*pow(y,3))*sin(t)
      </secondary>
    </anasol>
  </stokes>

  <discretization>
    <nGauss>5</nGauss>
  </discretization>

  <timestepping start="0" end="0.3" dt="0.1"/>

  <postprocessing>
    <stride>10</stride>
  </postprocessing>

</simulation>
